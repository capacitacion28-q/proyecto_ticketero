{
	"info": {
		"_postman_id": "ticketero-api-collection",
		"name": "Ticketero API",
		"description": "Colecci√≥n completa de endpoints para el sistema de tickets",
		"schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
	},
	"variable": [
		{
			"key": "baseUrl",
			"value": "http://localhost:8081",
			"type": "string"
		},
		{
			"key": "ticketUuid",
			"value": "",
			"type": "string"
		},
		{
			"key": "ticketNumber",
			"value": "",
			"type": "string"
		},
		{
			"key": "ticketId",
			"value": "",
			"type": "string"
		}
	],
	"item": [
		{
			"name": "üéØ ESCENARIO COMPLETO MANUAL",
			"item": [
				{
					"name": "PASO 1: üé´ Crear Ticket",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"// Auto-save variables from response",
									"if (pm.response.json()) {",
									"    const response = pm.response.json();",
									"    pm.collectionVariables.set('ticketUuid', response.codigoReferencia);",
									"    pm.collectionVariables.set('ticketNumber', response.numero);",
									"    pm.collectionVariables.set('ticketId', response.id);",
									"    console.log('‚úÖ Variables guardadas:');",
									"    console.log('ticketUuid:', response.codigoReferencia);",
									"    console.log('ticketNumber:', response.numero);",
									"    console.log('ticketId:', response.id);",
									"}"
								]
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"nationalId\": \"12345678\",\n  \"phoneNumber\": \"987654321\",\n  \"branchOffice\": \"Sucursal Centro\",\n  \"queueType\": \"CAJA\"\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/api/tickets",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"tickets"
							]
						},
						"description": "Crea ticket y guarda variables autom√°ticamente"
					}
				},
				{
					"name": "PASO 2: ‚ö° Verificar Estado (Scheduler)",
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{baseUrl}}/api/tickets/{{ticketUuid}}",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"tickets",
								"{{ticketUuid}}"
							]
						},
						"description": "Verifica estado del ticket (scheduler autom√°tico puede haberlo cambiado a ATENDIENDO)"
					}
				},
				{
					"name": "PASO 3: üìä Dashboard Inicial",
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{baseUrl}}/api/admin/summary",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"admin",
								"summary"
							]
						},
						"description": "Ver estado inicial del dashboard"
					}
				},
				{
					"name": "PASO 4: üë®üíº Asesor Disponible",
					"request": {
						"method": "PUT",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"status\": \"AVAILABLE\"\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/api/admin/advisors/1/status",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"admin",
								"advisors",
								"1",
								"status"
							]
						},
						"description": "Ejecutivo se desocupa"
					}
				},
				{
					"name": "PASO 5: üîó Asignar Ticket",
					"request": {
						"method": "PUT",
						"header": [],
						"url": {
							"raw": "{{baseUrl}}/api/admin/tickets/{{ticketId}}/assign/1",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"admin",
								"tickets",
								"{{ticketId}}",
								"assign",
								"1"
							]
						},
						"description": "Asignar ticket al ejecutivo"
					}
				},
				{
					"name": "PASO 6: üèÉ‚ôÇÔ∏è Verificar Atendiendo",
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{baseUrl}}/api/tickets/{{ticketNumber}}/position",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"tickets",
								"{{ticketNumber}}",
								"position"
							]
						},
						"description": "Verificar que est√° siendo atendido"
					}
				},
				{
					"name": "PASO 7: ‚úÖ Completar Atenci√≥n",
					"request": {
						"method": "PUT",
						"header": [],
						"url": {
							"raw": "{{baseUrl}}/api/admin/tickets/{{ticketId}}/status?status=COMPLETADO",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"admin",
								"tickets",
								"{{ticketId}}",
								"status"
							],
							"query": [
								{
									"key": "status",
									"value": "COMPLETADO"
								}
							]
						},
						"description": "Completar la atenci√≥n"
					}
				},
				{
					"name": "PASO 8: üîç Verificar Final",
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{baseUrl}}/api/tickets/{{ticketNumber}}/position",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"tickets",
								"{{ticketNumber}}",
								"position"
							]
						},
						"description": "Verificar estado final del ticket"
					}
				},
				{
					"name": "PASO 9: üìà Dashboard Final",
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{baseUrl}}/api/admin/summary",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"admin",
								"summary"
							]
						},
						"description": "Dashboard final con m√©tricas actualizadas"
					}
				}
			],
			"description": "Flujo completo paso a paso del escenario manual con variables autom√°ticas"
		},
		{
			"name": "üé´ Tickets - P√∫blico",
			"item": [
				{
					"name": "Crear Ticket",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"nationalId\": \"12345678\",\n  \"phoneNumber\": \"987654321\",\n  \"branchOffice\": \"Sucursal Centro\",\n  \"queueType\": \"CAJA\"\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/api/tickets",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"tickets"
							]
						},
						"description": "Crea un nuevo ticket en el sistema"
					}
				},
				{
					"name": "Consultar Ticket por UUID",
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{baseUrl}}/api/tickets/{{ticketUuid}}",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"tickets",
								"{{ticketUuid}}"
							]
						},
						"description": "Obtiene informaci√≥n de un ticket por su UUID"
					}
				},
				{
					"name": "Consultar Posici√≥n por N√∫mero",
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{baseUrl}}/api/tickets/{{ticketNumber}}/position",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"tickets",
								"{{ticketNumber}}",
								"position"
							]
						},
						"description": "Obtiene la posici√≥n actual de un ticket por su n√∫mero"
					}
				},
				{
					"name": "Consultar Tickets por C√©dula",
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{baseUrl}}/api/tickets/by-national-id/12345678",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"tickets",
								"by-national-id",
								"12345678"
							]
						},
						"description": "Obtiene todos los tickets activos de una c√©dula"
					}
				}
			],
			"description": "Endpoints p√∫blicos para gesti√≥n de tickets desde t√≥tems"
		},
		{
			"name": "üìä Dashboard - Admin",
			"item": [
				{
					"name": "Dashboard Completo",
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{baseUrl}}/api/admin/dashboard",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"admin",
								"dashboard"
							]
						},
						"description": "Obtiene m√©tricas completas del dashboard"
					}
				},
				{
					"name": "Resumen Dashboard",
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{baseUrl}}/api/admin/summary",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"admin",
								"summary"
							]
						},
						"description": "Obtiene resumen simplificado del dashboard"
					}
				},
				{
					"name": "Estado Cola CAJA",
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{baseUrl}}/api/admin/queue/CAJA",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"admin",
								"queue",
								"CAJA"
							]
						},
						"description": "Obtiene estado de la cola CAJA"
					}
				},
				{
					"name": "Estado Cola PERSONAL_BANKER",
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{baseUrl}}/api/admin/queue/PERSONAL_BANKER",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"admin",
								"queue",
								"PERSONAL_BANKER"
							]
						},
						"description": "Obtiene estado de la cola PERSONAL_BANKER"
					}
				},
				{
					"name": "Estado Cola EMPRESAS",
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{baseUrl}}/api/admin/queue/EMPRESAS",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"admin",
								"queue",
								"EMPRESAS"
							]
						},
						"description": "Obtiene estado de la cola EMPRESAS"
					}
				}
			],
			"description": "Endpoints administrativos para dashboard y m√©tricas"
		},
		{
			"name": "üë• Asesores - Admin",
			"item": [
				{
					"name": "Lista de Asesores",
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{baseUrl}}/api/admin/advisors",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"admin",
								"advisors"
							]
						},
						"description": "Obtiene lista de todos los asesores"
					}
				},
				{
					"name": "Estad√≠sticas de Asesores",
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{baseUrl}}/api/admin/advisors/stats",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"admin",
								"advisors",
								"stats"
							]
						},
						"description": "Obtiene estad√≠sticas detalladas de asesores"
					}
				},
				{
					"name": "Cambiar Estado Asesor",
					"request": {
						"method": "PUT",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"status\": \"AVAILABLE\"\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/api/admin/advisors/1/status",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"admin",
								"advisors",
								"1",
								"status"
							]
						},
						"description": "Cambia el estado de un asesor (AVAILABLE, BUSY, BREAK, OFFLINE)"
					}
				}
			],
			"description": "Endpoints administrativos para gesti√≥n de asesores"
		},
		{
			"name": "üîß Gesti√≥n Tickets - Admin",
			"item": [
				{
					"name": "Actualizar Estado Ticket",
					"request": {
						"method": "PUT",
						"header": [],
						"url": {
							"raw": "{{baseUrl}}/api/admin/tickets/{{ticketId}}/status?status=COMPLETADO",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"admin",
								"tickets",
								"{{ticketId}}",
								"status"
							],
							"query": [
								{
									"key": "status",
									"value": "COMPLETADO"
								}
							]
						},
						"description": "Actualiza el estado de un ticket (EN_ESPERA, PROXIMO, ATENDIENDO, COMPLETADO, CANCELADO)"
					}
				},
				{
					"name": "Asignar Ticket a Asesor",
					"request": {
						"method": "PUT",
						"header": [],
						"url": {
							"raw": "{{baseUrl}}/api/admin/tickets/{{ticketId}}/assign/1",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"admin",
								"tickets",
								"{{ticketId}}",
								"assign",
								"1"
							]
						},
						"description": "Asigna un ticket espec√≠fico a un asesor"
					}
				}
			],
			"description": "Endpoints administrativos para gesti√≥n de tickets"
		},
		{
			"name": "üè• Health Check",
			"item": [
				{
					"name": "Health Status",
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{baseUrl}}/actuator/health",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"actuator",
								"health"
							]
						},
						"description": "Verifica el estado de salud de la aplicaci√≥n"
					}
				},
				{
					"name": "Application Info",
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{baseUrl}}/actuator/info",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"actuator",
								"info"
							]
						},
						"description": "Obtiene informaci√≥n de la aplicaci√≥n"
					}
				},
				{
					"name": "Metrics",
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{baseUrl}}/actuator/metrics",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"actuator",
								"metrics"
							]
						},
						"description": "Obtiene m√©tricas de la aplicaci√≥n"
					}
				}
			],
			"description": "Endpoints de monitoreo y salud de la aplicaci√≥n"
		}
	],
	"event": [
		{
			"listen": "prerequest",
			"script": {
				"type": "text/javascript",
				"exec": [
					"// Log current variables",
					"console.log('üîß Variables actuales:');",
					"console.log('ticketUuid:', pm.collectionVariables.get('ticketUuid'));",
					"console.log('ticketNumber:', pm.collectionVariables.get('ticketNumber'));",
					"console.log('ticketId:', pm.collectionVariables.get('ticketId'));"
				]
			}
		}
	]
}